Criando Relatórios e Dashboards - Parte 2
---------------------------------------------------------------------------------------------------------


02-contruindo_o_layout_no_powerpoint

Primeiramente podemos baixar no google uma imagem para servir de fundo em nosso Menu do PowerBI, salvamos com extensão .jpg

Depois abriremos o powerpoint e criaremos um slide em branco, iremo em 'Menu Superior' -> 'Insert/Inserir' -> 'Imagem/Pictures' e faremos a inserção da imagem escolhida, após isso colocaremos a imagem do tamanho da página (primeira página)

Depois para criar o efeito 'esfumaçado' ou 'embaçado' criaremos uma forma de retângulo e colocaremos por cima da imagem, para isso vamos em Menu Superior -> 'Insert/Inserir' -> 'Formas/Shapes' ->'Retangulo/Rectangle' e expandiremos o retangulo até que ele cubra toda a imagem/pagina

Para mudar as cores e propriedades do retangulo por cima da imagem clicaremos com o segundo botão do mouse e iremos na opção 'Formatar Forma/Format Shape' -> 'Opções de Forma/Shape Options' -> 'Preenchimento/Fill' -> 'Transparencia/Transparency' -> ~12%

Para pintar a forma iremos no 'Menu Superior' -> 'Formato da Forma/Shape Format' -> 'Preenchimento da Forma/Shape Fill' e escolher a cor

Depois podemos inserir caixas de texto, para isso iremos em Menu Superior -> 'Inserir/Insert' -> 'Caixa de Texto/Text Box' e escrever o que for necessário nas text box

Podemos incluir também ícones em nosso menu inicial, para isso o ideal é irmos no site flaticon.com e procurar pelos icones desejados, caso seja necessário mudar a cor podemos ir nas opções de cada um e escolher a cor desejada.
Após baixar a imagem para inserir elas no powerpoint iremos no 'Menu Superior' -> 'Insert/Inserir' -> 'Imagens/Pictures'


---------------------------------------------------------------------------------------------------------


03-construindo_o_layout_no_powerpoint-parte2

Agora vamos criar layouts para serem usados para os graficos em si, onde montaremos os graficos posteriormente do powerbi, funcionarão como molduras.

Vamos inserir uma barra na parte superior do slide para servir de titulo, para isso iremos em 'Menu Superior' -> 'Formas/Shapes' -> 'Retangulo/Rectangle' e faremos a inserção como se fosse um menu superior

Pelo mesmo processo incluiremos uma linha mais fina um pouco abaixo da barra na parte superior

Depois disso faremos uma cópia do logo da primeira página para a segunda com CTRL + C e CTRL + V

Logo então faremos a inserção das formas no power point onde depois ficaram cada um de nossos gráficos do power bi.


---------------------------------------------------------------------------------------------------------


04-construindo_o_layout_no_powerpoint-parte3

Primeiramente importante saber que podemos colocar algumas imagens por cima de outras de acordo com a necessidade, para fazer isso clicaremos na imagem e no 'Menu Superior' -> 'Formato de Forma/Shape Format' -> 'Avançar/Bring Forward' -> 'Avançar/Bring Forward'

Outro detalhe é que o contorno das formas geralmente fica em uma cor diferente da cor da própria forma, para acertar isso (caso seja do interesse) clicaremos na forma e iremos em 'Menu Superior' -> 'Formato da Forma/Shape Format' -> 'Contorno da Forma/Shape Outline' e escolheremos a cor desejada (pode ser a cor da própria forma que em geral está no campo 'Cores usadas recentemente')

Ao criarmos várias formas que seja necessário alinhá-las vertical e horizontalmente podemos seguir os seguintes passos: selecionamos todas vamos em 'Menu Superior' -> 'Formato de Forma/Shape Format' -> 'Centralizar/Align Center', feito isso as figuras estarão alinhadas horizontalmente, poderemos arrastá-las para o local desejado.

Para alinhá-las verticalmente selecionaremos novamente todas elas, iremos em 'Menu Superior' -> 'Formato de Forma/Shape Format' -> 'Distribuir Verticalmente/Distribute Vertically'


---------------------------------------------------------------------------------------------------------


05-preparando_o_layout_do_relatorio_no_powerbi

Ao criarmos os layouts de papel de parede no powerpoint teremos que salvar eles como imagem para serem utilizados no power bi.

Para isso iremos no powerpoint no 'Menu Superior' -> 'Arquivo/File' -> 'Salvar Como/Save As' e salvar TODOS os slides como PNG

Para inserir um papel de parede criaremos um pagina em branco no PowerBI, iremos na aba 'Visualizações' -> 'Formato da Página' -> 'Tela de fundo' -> 'Imagem'. Observe que normalmente a transparencia fica setada em 100% tornado a imagem invisivel, para corrigir acertar a transparencia para 0%


---------------------------------------------------------------------------------------------------------


06-criando_as_medidas_e_cartoes-parte1

BOAS PRÁTICAS:
Ao criar medidas é desejável criar uma nova Tabela para incluir TODAS as medidas vinculadas a apenas uma tabela de modo a facilitar e centralizar seu uso.
Para criar a nova tabela iremos em 'Menu Superior' -> 'Pagina Inicial' -> 'Inserir dados' -> (nome Medidas ou algo que seja intuitivo)

Para criar as novas medidas iremos na tabela 'Medidas' clicaremos com o segundo botão do mouse e iremos em 'Nova medida'


---------------------------------------------------------------------------------------------------------


07-criando_as_medidas_e_cartoes-parte2
 
Para FORMATAR a medida para por exemplo aparecer como moeda devemos CLICAR NA MEDIDA no Menu Lateral Direito, ir em 'Menu Superior' -> 'Ferramentas de Medida' -> 'Formato' -> 'Moeda'. Caso seja necessário escolher uma moeda específica como Real ou Dollar clicaremos no símbolo de '$' e escolhemos a moeda (Real aparece na letra P em português)


---------------------------------------------------------------------------------------------------------


10-grafico_de_area_e_como_ordenar_o_grafico_por_mes

*** IMPORTANTE , só utilizaremos a divisão por 'Início do Mês' caso nossa necessidade seja de uma analise divida 'Mês a Mês' levando os anos diferentes em consideração, caso a análise seja feita em função apenas do mês (acumulando os valores no decorrer do ano) utilizaremos 'Mês' ou 'Nome do Mês'

*** ORDERNAÇÃO DE GRAFICO POR ORDEM CRONOLOGICA (MESES EM ORDEM DE JANEIRO A DEZEMBRO)

Vamos na aba 'Exibição de dados' no menu lateral esquerdo, lá vamos clicar na coluna 'Nome do Mês', depois no Menu Superior em 'Ferramentas de coluna' -> 'Classificar por coluna' -> 'Mês', o que fizemos aqui foi ALTERAR O CRITÉRIO de ordenação de 'Nome do Mês' para 'Mês' (onde este último usa o número do mês como critério para classificação)

Isso garantirá que o mês, mesmo que representado pelo seu nome, fique a ordem de seus números nos gráficos: janeiro, fevereiro, março...	


---------------------------------------------------------------------------------------------------------


12-formatacao_condicional_de_grafico

Para criar a formatação condicional em função da COR escolheremos o gráfico no dashboard, iremos na aba 'Visualizações' -> 'Formatar o Visual' -> 'Cores' -> 'Botão de função fx'

Aí escolheremos qual a medida desejamos utilizar para a formatação condicional, fazendo com que troque a cor da barra do gráfico de acordo com o valor que essa medida seja de acordo com a opção


---------------------------------------------------------------------------------------------------------


13-grafico_de_arvore_e_filtro_top_n

Primeiro incluiremos o gráfico 'Treemap' que está na aba 'Visualizações'

Clicaremos no gráfico e incluiremos a medida 'Total de Pedidos' no campo 'Valores' na aba 'Visualizações', depois incluiremos a coluna 'Nome Completo' da tabela 'Clientes' no campo 'Categoria' na aba visualizações

Para filtrar os 5 primeiros em número de pedidos iremos na aba 'Filtros' em 'Filtros neste visual' (funciona apenas naquele gráfico) na parte direita incluiremos em 'Adicionar campos...' o Código do Cliente, pois usar o nome pode gerar problemas devido a homonimos, seguindo colocaremos o tipo de filtro 'N superior' -> 'Mostrar itens' -> '5' e no campo 'Por valor' incluiremos a medida 'Total Pedidos'


---------------------------------------------------------------------------------------------------------


14-grafico_de_mapa

Para incluir o grafico de Mapa vamos na aba a direita de 'Visualizações' e escolhemos o gráfico que possui desenho de um globo terrestre

Precisamos colocar na opção 'Localização' da aba 'Visualizações' as colunas referentes aos locais que serão apontados no mapa (cidades, estados, etc) e no 'Tamanho da bolha' as medidas/colunas que informam o que queremos diferenciar por meio do tamanho do circulo que está na localizacao (faturamento, numero de clientes, etc)

Importante sempre utilizar preencher a aba 'Localizações' com as informações da tabelas características (como Lojas) e não tabelas fatos, caso seja feito com algum item da tabela fatos ele só terá interação nos outros campos do dashboard com os itens que tiverem relação COM AQUELA TABELA FATO e NÃO COM AS OUTRAS TABELAS FATOS, o motivo de que isso acontece é que NÃO EXISTE RELACIONAMENTO ENTRE DIFERENTES TABELAS FATOS.

Para evitar o uso das colunas não indicadas podemos ocultá-las da aba de visualização do relatório de modo que elas não possam ser inseridas nos gráfico, para isso vamos no meu lateral esquerdo em 'Exibição de dados' -> Abrimos a tabela desejada -> Clicamos com o segundo botão do mouse no título da coluna que desejamos ocultar -> Clicamos na opção 'Ocultar da visualização de relatório'


---------------------------------------------------------------------------------------------------------


15-grafico_de_coluna

Para adicionar o gráfico de coluna iremos na aba 'Visualizações' e escolhemos o gráfico 'Gráfico de colunas empilhadas'

Selecionaremos a medida 'Lucro Total' para o eixo Y e a coluna 'Marca' da Tabela 'Produtos' para podermos analisar o lucro recebido por cada marca. A tabela inicialmente vai mostrar as marcas em ordem descrescente de lucro, para alteramos para ordem alfabética teremos que ir no canto superior direito do próprio gráfico nos icone dos três pontinhos (...) -> 'Classificar eixo' -> 'Marca' e depois escolher a opção 'Em ordem crescente'


---------------------------------------------------------------------------------------------------------


16-criando_analises_inteligentes_com_o_filtro_drill_down

Quando clicamos em uma marca ou categoria em um gráfico do powerbi o natural/default é que todos os outros gráficos reajam a essa seleção utilizando a opção REALCE (quando ele não apaga os outros dados mas apenas realça os que foram selecionados), podemos alterar essa opção para que por padrão ele FILTRE em vez de REALÇAR, para isso vamos em 'Menu Superior' -> 'Arquivo' -> 'Opções e configurações' -> 'Opções' -> 'Configurações do relatório' -> 'Opções visuais' -> 'Alterar a interação visual padrão de realce cruzado para filtragem cruzada'

OBS: Podemos efetuar essa configuração de outra maneira personalizando para cada gráfico se for do interesse em vez de já deixa-la ligada para TODOS os gráficos


Podemos também fazer com que um gráfico funcione para mais de um parametro, como por exemplo o gráfico de Lucro Total x Marca, pode também funcionar como Lucro Total x Categoria e Lucro Total x Produto. Para isso pegaremos as colunas desejadas e incluiremos TODAS elas uma abaixo da outra no 'Eixo X', após isso será criado um menu na parte do cima do gráfico, feito isso poderemos navegar pelas opções com a 'seta para cima' e as 'duas setas para baixo', criando uma hierarquia entre as colunas utilizadas para representar o gráfico.

Podemos também clicar na 'seta para baixo' para habilitar o drill down, isso significa ter filtros multiplos, onde ao clicar em uma marca e categoria por exemplo TODO o dashboard criará filtros vinculados aos dois parametros escolhidos (marca e categoria), ou seja em vez de aplicar o filtro apenas à SAMSUNG ou aos NOTEBOOKS podemos aplicar filtros aos NOTEBOOKS da SAMSUNG acumulando os filtros.

Podemos também usar o 'garfo invertido' para andar um nivel abaixo da categoria, o que significa atrelar mais informações ao gráfico como em vez de aparecer apenas a MARCA passará a aparecer a MARCA e a CATEGORIA, clicando uma segunda vez ele vai a um nivel mais baixo ainda mostrando MARCA, CATEGORIA e PRODUTO.


---------------------------------------------------------------------------------------------------------


17-segmentacao_de_dados-parte1

Segmentação de Dados são filtros feitos para que os dados possam ser expostos de maneira diferente to seu TOTAL, como por exemplo expor os dados por ANO ou MÊS.

Para incluir uma segmentação de dados vamos na aba da direita em 'Visualizações' e escolhemos o gráfico de 'Segmentação de dados'

Por padrão ele virá na opção de menu deslizante, para alterarmos a opção teremos que ir na aba a direita 'Visualizações' -> 'Formatar o visual' -> 'Configurações de segmentação' -> 'Opções' -> 'Estilo'

Para fazer seleções múltiplas de anos precisamos segurar o CTRL enquanto efetuamos o segundo clique, para que seja possível esse tipo de seleção sem utilizar o CTRL iremos no menu lateral 'Visualizações' -> 'Formatar o visual' -> 'Visual' -> 'Seleção' -> e desmarcamos a opção 'Seleção múltipla com CTRL'


---------------------------------------------------------------------------------------------------------


19-criando_medidas-parte1

Vamos criar medidas visando saber o quanto as vendas caíram ou subíram em relação a cada categoria de produto de um mês para outro (do penúltimo mês para o último mês existente no calendário atual)

Para fins de testes vamos criar uma MATRIZ utilizando a aba a direita 'Visualizações' -> 'Criar Visual' -> 'Matriz' , logo depois vamos colocar na opção 'Linhas' da Matriz a informação de 'Início do Mês' presenta na tabela 'Calendário', clicaremos com o segundo botão do mouse na opção 'Início do Mês' que está inserida em 'Linhas', logo depois disso alteraremos a exibição de datas de 'Hierarquia de datas' para 'Início do mês'

Agora adicionaremos a medida 'Total Faturamento' no campo 'Valores' da Matriz

Observe que a coluna 'Início do Mês' possui uma data do primeiro dia do mês em seu valor, embora seja apenas a data de apenas um dia o faturamento correspondente na coluna 'Total Faturamento' é do mês todo, então é desejável que façamos a alteração de apenas uma data como está na coluna 'Início do Mês' para algo que represente o mês todo.

Para efetuarmos essa alteração iremos no menu lateral esquerdo em 'Exibição de dados' depois na tabela 'Calendário' e depois no título da coluna 'Início do Mês', após isso iremos no 'Menu Superior' -> 'Ferramentas de Coluna' -> 'Formato' e escolheremos a formatação desejada para que apareça como se fosse o mês inteiro e não apenas o primeiro dia do mês.

Para terminarmos a nossa medida desejada comparando o faturamento do ultimo mês com do penultimo criaremos uma medida, sendo assim:
	Faturamento Mês Anterior = CALCULATE([Total Faturamento],DATEADD('Calendário'[Data],-1,MONTH))

onde a formula CALCULATE efetuará um filtro da medida TOTAL FATURAMENTO, DATEADD fará um deslocamento de data, 'Calendário'[Data] representa todas as datas do calendário e -1 MONTH representa um mês antes da data atual que 'Calendário'[Data] representa.


---------------------------------------------------------------------------------------------------------


20-criando_medidas-parte2

Agora vamos criar uma medida para calcular qual o percentual de alteração do faturamento em relaçao do ultimo mes para o penultimo, para isso utilizaremos a formula basica:

	Percentual de alteração = (ult. faturamento - penult. faturamento)/penult. faturamento

Criaremos a medida com a fórmula:

	% Variação Faturamento = ([Total Faturamento] - [Faturamento Mês Anterior])/[Faturamento Mês Anterior]

porém podemos melhorar a fórmula utilizando a função DIVIDE, pois no caso acima o primeiro resultado será 'Infinito' pois a ausencia de faturamento no mês anterior leva a uma 'quase' divisão por zero, portanto a formula mais indicada é:

	% Variação Faturamento = DIVIDE([Total Faturamento] - [Faturamento Mês Anterior],[Faturamento Mês Anterior],"Sem Vendas")

O argumento "Sem Vendas" será a resposta da função caso seja impossível efetuar o cálculo. (argumento opcional)


---------------------------------------------------------------------------------------------------------


21-grafico_de_scroller

IMPORTANTE: O gráfico de scroller não está por default disponível no Power BI, para utilizá-lo precisamos baixá-lo e para isso criar uma conta para conseguir esses gráficos extras

Para conseguir esses gráficos extras temos que ir na aba a direita chamada 'Visualizações' -> 'Criar visual' -> Ir na última opção de gráficos que são um três pontinhos (...) -> 'Obter mais visuais'

Para incluir o gráfico iremos novamente na aba 'Visualizações' -> 'Criar Visual' -> e nas ultimas opções onde consta o gráfico 'Scroller' baixado

Em 'Category' iremos incluir o que desejamos estudar no caso vamos incluir a 'Categoria' na tabela 'Produtos', em 'Measure Absolute' vamos incluir qual medida será o parametro de evolução ou alteração, nesse caso 'Total Faturamento' e no campo 'Measure Deviation' vamos incluir qual será o tipo de variação a ser analisado, nesse caso '% Variação Faturamento'.

O gráfico pode aparecer apagado, isso pode se dar porque o título está ocupando o espaço destinado ao gráfico, para corrigir isso basta ir na aba da direita 'Visualizaçoes' -> 'Formatar o visual' -> Desabilitar o 'Título'

Inicialmente o faturamento que vai aparecer no gráfico será referente ao ano inteiro, para acertar o faturamento apenas para o último mês teremos que ir na aba a direita 'Filtros' -> vamos acrescentar o filtro da coluna 'Início do Mês' arrastando ela até o campo em branco na aba 'Filtros' e escolhendo a opção 'Tipo de filtro' -> 'N superior' -> 'Mostrar itens' -> 'Superior' -> 1 -> 'Por valor' -> adicionar a coluna 'Início do Mês'

Podemos também pintar as letras das categorias de acordo com uma lógica onde fiquem vermelhas as letras onde o faturamento caiu e verde onde o faturamento subiu, para isso selecionamos o gráfico de scroller, vamos na aba a direita 'Visualizações' -> 'Formatar o visual' -> 'Scroller' -> 'Status text coloring' -> ON


---------------------------------------------------------------------------------------------------------


22-tooltip-dicas_de_ferramentas-opcao_basica

Os tooltip são os 'baloes de informações' que aparecem quando passamos o mouse por cima de algum gráfico, eles constam como ligados por default, acontece que nós podemos incluir outras informações nesses 'baloes' de forma a incrementar as informações obtidas nos tooltips.

Para utilizarmos em sua forma básica nós selecionamos o gráfico desejado vamos na aba a direita 'Visualizações' -> 'Criar Visual' -> 'Dicas de ferramentas' e vamos adicionando todas as informações que gostariamos que fossem visualizadas quando passassemos o mouse na area do grafico.


---------------------------------------------------------------------------------------------------------